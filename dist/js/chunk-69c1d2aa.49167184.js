(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69c1d2aa"],{"159b":function(e,t,n){var r=n("da84"),s=n("fdbc"),a=n("17c2"),i=n("9112");for(var o in s){var c=r[o],u=c&&c.prototype;if(u&&u.forEach!==a)try{i(u,"forEach",a)}catch(l){u.forEach=a}}},"17c2":function(e,t,n){"use strict";var r=n("b727").forEach,s=n("a640"),a=n("ae40"),i=s("forEach"),o=a("forEach");e.exports=i&&o?[].forEach:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}},"2bfd":function(e,t,n){},"3ca3":function(e,t,n){"use strict";var r=n("6547").charAt,s=n("69f3"),a=n("7dd0"),i="String Iterator",o=s.set,c=s.getterFor(i);a(String,"String",(function(e){o(this,{type:i,string:String(e),index:0})}),(function(){var e,t=c(this),n=t.string,s=t.index;return s>=n.length?{value:void 0,done:!0}:(e=r(n,s),t.index+=e.length,{value:e,done:!1})}))},4160:function(e,t,n){"use strict";var r=n("23e7"),s=n("17c2");r({target:"Array",proto:!0,forced:[].forEach!=s},{forEach:s})},"4de4":function(e,t,n){"use strict";var r=n("23e7"),s=n("b727").filter,a=n("1dde"),i=n("ae40"),o=a("filter"),c=i("filter");r({target:"Array",proto:!0,forced:!o||!c},{filter:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}})},6547:function(e,t,n){var r=n("a691"),s=n("1d80"),a=function(e){return function(t,n){var a,i,o=String(s(t)),c=r(n),u=o.length;return c<0||c>=u?e?"":void 0:(a=o.charCodeAt(c),a<55296||a>56319||c+1===u||(i=o.charCodeAt(c+1))<56320||i>57343?e?o.charAt(c):a:e?o.slice(c,c+2):i-56320+(a-55296<<10)+65536)}};e.exports={codeAt:a(!1),charAt:a(!0)}},7156:function(e,t,n){var r=n("861d"),s=n("d2bb");e.exports=function(e,t,n){var a,i;return s&&"function"==typeof(a=t.constructor)&&a!==n&&r(i=a.prototype)&&i!==n.prototype&&s(e,i),e}},"7db0":function(e,t,n){"use strict";var r=n("23e7"),s=n("b727").find,a=n("44d2"),i=n("ae40"),o="find",c=!0,u=i(o);o in[]&&Array(1)[o]((function(){c=!1})),r({target:"Array",proto:!0,forced:c||!u},{find:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),a(o)},8418:function(e,t,n){"use strict";var r=n("c04e"),s=n("9bf2"),a=n("5c6c");e.exports=function(e,t,n){var i=r(t);i in e?s.f(e,i,a(0,n)):e[i]=n}},"87cf":function(e,t,n){"use strict";n("4de4"),n("7db0"),n("4160"),n("a15b"),n("d81d"),n("159b"),n("96cf");var r=n("1da1"),s=n("1146"),a=n.n(s),i=n("bc3a"),o=n.n(i);t["a"]={name:"excelMixin",data:function(){return{localMossadId:null,allEmpsInfo:[],codeDescription:[],empsHours:[],dataToExport:[]}},mounted:function(){this.getCodesDescription()},methods:{createWeeklyHoursToMossad:function(e,t,n){var s=this;return Object(r["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,s.getAllEmpInfo(e,t,n);case 2:return r.next=4,s.getAllEmpHours(e,t,n);case 4:return r.next=6,s.setWeeklyHoursAndExport(e);case 6:s.dataToExport=[],s.allEmpsInfo=[],s.empsHours=[];case 9:case"end":return r.stop()}}),r)})))()},createWeeklyHoursToEmployee:function(e,t,n,s){var a=this;return Object(r["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,a.getEmpInfo(e,t,n,s);case 2:return r.next=4,a.getEmpHours(e,t,n,s);case 4:return r.next=6,a.setWeeklyHoursAndExport(t);case 6:a.dataToExport=[],a.allEmpsInfo=[],a.empsHours=[];case 9:case"end":return r.stop()}}),r)})))()},setWeeklyHoursAndExport:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r="",n.next=3,o.a.get("/mossadot/byId",{params:{mossadId:e}}).then((function(e){r=e.data.mossadName})).catch((function(e){return t.$store.dispatch("displayErrorMessage",{error:e})}));case 3:t.allEmpsInfo.forEach((function(n){t.setExistHours(n,t.empsHours.filter((function(e){return e.empId==n.empId})),e,r)})),t.setDataForDisplay(t.dataToExport),t.downloadFile(t.dataToExport,t.getWeeklyHoursHeaders(),"מצבת שעות.xlsx","מערכת שעות פרונטליות");case 6:case"end":return n.stop()}}),n)})))()},getEmpHours:function(e,t,n,s){var a=this;return Object(r["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,o.a.get("/teacherEmploymentDetails/byMossad",{params:{empId:e,mossadId:t,begda:n,endda:s}}).then((function(e){a.empsHours=e.data})).catch((function(e){return a.$store.dispatch("displayErrorMessage",{error:e})}));case 2:case"end":return r.stop()}}),r)})))()},getEmpInfo:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,o.a.get("/employees/byId",{params:{empId:e}}).then((function(e){t.allEmpsInfo.push(e.data)})).catch((function(e){return t.$store.dispatch("displayErrorMessage",{error:e})}));case 2:case"end":return n.stop()}}),n)})))()},getAllEmpInfo:function(e,t,n){var s=this;return Object(r["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,o.a.get("/employees/byMossad",{params:{mossadId:e,begda:t,endda:n}}).then((function(e){s.allEmpsInfo=e.data})).catch((function(e){return s.$store.dispatch("displayErrorMessage",{error:e})}));case 2:case"end":return r.stop()}}),r)})))()},getAllEmpHours:function(e,t,n){var s=this;return Object(r["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,o.a.get("/teacherEmploymentDetails/allByMossad",{params:{mossadId:e,begda:t,endda:n}}).then((function(e){s.empsHours=e.data})).catch((function(e){return s.$store.dispatch("displayErrorMessage",{error:e})}));case 2:case"end":return r.stop()}}),r)})))()},getCodesDescription:function(){var e=this;o.a.get("/convertHours/all").then((function(t){e.codeDescription=t.data})).catch((function(t){return e.$store.dispatch("displayErrorMessage",{error:t})}))},downloadDemoFile:function(){var e=[];this.downloadFile(e,this.getWeeklyHoursHeaders(),"מצבת שעות.xlsx","מערכת שעות פרונטליות")},downloadFile:function(e,t,n,r){var s=e;s.unshift(t);var i=a.a.utils.json_to_sheet(s,{skipHeader:!0,Views:[{RTL:!0}]}),o=a.a.utils.book_new();a.a.utils.book_append_sheet(o,i,r),this.set_right_to_left(o),a.a.writeFile(o,n)},set_right_to_left:function(e){e.Workbook||(e.Workbook={}),e.Workbook.Views||(e.Workbook.Views=[]),e.Workbook.Views[0]||(e.Workbook.Views[0]={},e.Workbook.Views[0].RTL=!0)},setExistHours:function(e,t,n,r){var s=this,a={},i=[];t.forEach((function(t){void 0==i.find((function(e){return e.code==t.empCode&&e.begda==t.begda&&e.endda==t.endda}))&&(a={empId:e.empId,lastName:e.lastName,firstName:e.firstName,ageHours:s.getAgeHours(e.birthDate),isMother:s.getIsMother(e.mother),code:t.empCode,codeDescription:s.getCodeDescription(t.empCode),mossadId:n+"100",mossadName:r,begda:t.begda,endda:t.endda,Sunday:0,Monday:0,Tuesday:0,Wednesday:0,Thursday:0,Friday:0,totalHours:0,reformType:s.getReformType(t.empCode),systemMessages:""},i.push(a)),s.setHoursInDay(i.find((function(e){return e.code==t.empCode&&e.begda==t.begda&&e.endda==t.endda})),t.day,t.hours)})),this.dataToExport.push.apply(this.dataToExport,i)},sortWeeklyhoursTable:function(e){e.sort((function(e,t){return e.empCode-t.empCode}))},getWeeklyHoursHeaders:function(){var e={empId:"מספר עובד",lastName:"שם משפחה",firstName:"שם פרטי",ageHours:"שעות גיל",isMother:"מורה אם",code:"פיצול",codeDescription:"תאור פיצול",mossadId:"מוסד",mossadName:"שם מוסד",begda:"מתאריך",endda:"עד תאריך",Sunday:"א'",Monday:"ב'",Tuesday:"ג'",Wednesday:"ד",Thursday:"ה'",Friday:"ו'",totalHours:'סה"כ שעות פרונטליות',reformType:"רפורמה",systemMessages:"הערות מערכת"};return e},setDataForDisplay:function(e){var t=this;e.forEach((function(e){e.begda=t.formattedDate(e.begda),e.endda=t.formattedDate(e.endda)}))},setHoursInDay:function(e,t,n){0==t?e.Sunday+=n:1==t?e.Monday+=n:2==t?e.Tuesday+=n:3==t?e.Wednesday+=n:4==t?e.Thursday+=n:5==t&&(e.Friday+=n),e.totalHours+=n},formattedDate:function(e){var t=new Date(e);return[t.getDate(),t.getMonth()+1,t.getFullYear()].map((function(e){return e<10?"0".concat(e):"".concat(e)})).join("/")},fromatGenderText:function(e){return"F"==e?"נקבה":"זכר"},formatMotherType:function(e){return 1==e?"כן":"לא"},getIsMother:function(e){return"לא"==e?0:1},getAgeHours:function(e){var t=new Date(e),n=new Date,r=new Date(n.getFullYear(),8,1);n.getUTCMonth()>8&&r.setFullYear(r.getFullYear()+1);var s=r.getFullYear()-t.getFullYear();return s<50?0:s>55?4:2},getCodeDescription:function(e){return this.codeDescription.find((function(t){return t.code==e})).codeDescription},getReformType:function(e){this.codeDescription.find((function(t){return t.code==e}));return"TODO"}}}},a15b:function(e,t,n){"use strict";var r=n("23e7"),s=n("44ad"),a=n("fc6a"),i=n("a640"),o=[].join,c=s!=Object,u=i("join",",");r({target:"Array",proto:!0,forced:c||!u},{join:function(e){return o.call(a(this),void 0===e?",":e)}})},c6a6:function(e,t,n){"use strict";n("2bfd");var r=n("b974"),s=n("8654"),a=n("d9f7"),i=n("80d2");const o={...r["b"],offsetY:!0,offsetOverflow:!0,transition:!1};t["a"]=r["a"].extend({name:"v-autocomplete",props:{allowOverflow:{type:Boolean,default:!0},autoSelectFirst:{type:Boolean,default:!1},filter:{type:Function,default:(e,t,n)=>n.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())>-1},hideNoData:Boolean,menuProps:{type:r["a"].options.props.menuProps.type,default:()=>o},noFilter:Boolean,searchInput:{type:String}},data(){return{lazySearch:this.searchInput}},computed:{classes(){return{...r["a"].options.computed.classes.call(this),"v-autocomplete":!0,"v-autocomplete--is-selecting-index":this.selectedIndex>-1}},computedItems(){return this.filteredItems},selectedValues(){return this.selectedItems.map(e=>this.getValue(e))},hasDisplayedItems(){return this.hideSelected?this.filteredItems.some(e=>!this.hasItem(e)):this.filteredItems.length>0},currentRange(){return null==this.selectedItem?0:String(this.getText(this.selectedItem)).length},filteredItems(){return!this.isSearching||this.noFilter||null==this.internalSearch?this.allItems:this.allItems.filter(e=>{const t=Object(i["q"])(e,this.itemText),n=null!=t?String(t):"";return this.filter(e,String(this.internalSearch),n)})},internalSearch:{get(){return this.lazySearch},set(e){this.lazySearch=e,this.$emit("update:search-input",e)}},isAnyValueAllowed(){return!1},isDirty(){return this.searchIsDirty||this.selectedItems.length>0},isSearching(){return this.multiple&&this.searchIsDirty||this.searchIsDirty&&this.internalSearch!==this.getText(this.selectedItem)},menuCanShow(){return!!this.isFocused&&(this.hasDisplayedItems||!this.hideNoData)},$_menuProps(){const e=r["a"].options.computed.$_menuProps.call(this);return e.contentClass=("v-autocomplete__content "+(e.contentClass||"")).trim(),{...o,...e}},searchIsDirty(){return null!=this.internalSearch},selectedItem(){return this.multiple?null:this.selectedItems.find(e=>this.valueComparator(this.getValue(e),this.getValue(this.internalValue)))},listData(){const e=r["a"].options.computed.listData.call(this);return e.props={...e.props,items:this.virtualizedItems,noFilter:this.noFilter||!this.isSearching||!this.filteredItems.length,searchInput:this.internalSearch},e}},watch:{filteredItems:"onFilteredItemsChanged",internalValue:"setSearch",isFocused(e){e?(document.addEventListener("copy",this.onCopy),this.$refs.input&&this.$refs.input.select()):(document.removeEventListener("copy",this.onCopy),this.updateSelf())},isMenuActive(e){!e&&this.hasSlot&&(this.lazySearch=null)},items(e,t){t&&t.length||!this.hideNoData||!this.isFocused||this.isMenuActive||!e.length||this.activateMenu()},searchInput(e){this.lazySearch=e},internalSearch:"onInternalSearchChanged",itemText:"updateSelf"},created(){this.setSearch()},destroyed(){document.removeEventListener("copy",this.onCopy)},methods:{onFilteredItemsChanged(e,t){e!==t&&(this.setMenuIndex(-1),this.$nextTick(()=>{this.internalSearch&&(1===e.length||this.autoSelectFirst)&&(this.$refs.menu.getTiles(),this.setMenuIndex(0))}))},onInternalSearchChanged(){this.updateMenuDimensions()},updateMenuDimensions(){this.isMenuActive&&this.$refs.menu&&this.$refs.menu.updateDimensions()},changeSelectedIndex(e){this.searchIsDirty||(this.multiple&&e===i["w"].left?-1===this.selectedIndex?this.selectedIndex=this.selectedItems.length-1:this.selectedIndex--:this.multiple&&e===i["w"].right?this.selectedIndex>=this.selectedItems.length-1?this.selectedIndex=-1:this.selectedIndex++:e!==i["w"].backspace&&e!==i["w"].delete||this.deleteCurrentItem())},deleteCurrentItem(){const e=this.selectedIndex,t=this.selectedItems[e];if(!this.isInteractive||this.getDisabled(t))return;const n=this.selectedItems.length-1;if(-1===this.selectedIndex&&0!==n)return void(this.selectedIndex=n);const r=this.selectedItems.length,s=e!==r-1?e:e-1,a=this.selectedItems[s];a?this.selectItem(t):this.setValue(this.multiple?[]:null),this.selectedIndex=s},clearableCallback(){this.internalSearch=null,r["a"].options.methods.clearableCallback.call(this)},genInput(){const e=s["a"].options.methods.genInput.call(this);return e.data=Object(a["a"])(e.data,{attrs:{"aria-activedescendant":Object(i["o"])(this.$refs.menu,"activeTile.id"),autocomplete:Object(i["o"])(e.data,"attrs.autocomplete","off")},domProps:{value:this.internalSearch}}),e},genInputSlot(){const e=r["a"].options.methods.genInputSlot.call(this);return e.data.attrs.role="combobox",e},genSelections(){return this.hasSlot||this.multiple?r["a"].options.methods.genSelections.call(this):[]},onClick(e){this.isInteractive&&(this.selectedIndex>-1?this.selectedIndex=-1:this.onFocus(),this.isAppendInner(e.target)||this.activateMenu())},onInput(e){if(this.selectedIndex>-1||!e.target)return;const t=e.target,n=t.value;t.value&&this.activateMenu(),this.internalSearch=n,this.badInput=t.validity&&t.validity.badInput},onKeyDown(e){const t=e.keyCode;r["a"].options.methods.onKeyDown.call(this,e),this.changeSelectedIndex(t)},onSpaceDown(e){},onTabDown(e){r["a"].options.methods.onTabDown.call(this,e),this.updateSelf()},onUpDown(e){e.preventDefault(),this.activateMenu()},selectItem(e){r["a"].options.methods.selectItem.call(this,e),this.setSearch()},setSelectedItems(){r["a"].options.methods.setSelectedItems.call(this),this.isFocused||this.setSearch()},setSearch(){this.$nextTick(()=>{this.multiple&&this.internalSearch&&this.isMenuActive||(this.internalSearch=!this.selectedItems.length||this.multiple||this.hasSlot?null:this.getText(this.selectedItem))})},updateSelf(){(this.searchIsDirty||this.internalValue)&&(this.valueComparator(this.internalSearch,this.getValue(this.internalValue))||this.setSearch())},hasItem(e){return this.selectedValues.indexOf(this.getValue(e))>-1},onCopy(e){var t,n;if(-1===this.selectedIndex)return;const r=this.selectedItems[this.selectedIndex],s=this.getText(r);null==(t=e.clipboardData)||t.setData("text/plain",s),null==(n=e.clipboardData)||n.setData("text/vnd.vuetify.autocomplete.item+plain",s),e.preventDefault()}}})},d58f:function(e,t,n){var r=n("1c0b"),s=n("7b0b"),a=n("44ad"),i=n("50c4"),o=function(e){return function(t,n,o,c){r(n);var u=s(t),l=a(u),d=i(u.length),h=e?d-1:0,p=e?-1:1;if(o<2)while(1){if(h in l){c=l[h],h+=p;break}if(h+=p,e?h<0:d<=h)throw TypeError("Reduce of empty array with no initial value")}for(;e?h>=0:d>h;h+=p)h in l&&(c=n(c,l[h],h,u));return c}};e.exports={left:o(!1),right:o(!0)}},d81d:function(e,t,n){"use strict";var r=n("23e7"),s=n("b727").map,a=n("1dde"),i=n("ae40"),o=a("map"),c=i("map");r({target:"Array",proto:!0,forced:!o||!c},{map:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}})},ddb0:function(e,t,n){var r=n("da84"),s=n("fdbc"),a=n("e260"),i=n("9112"),o=n("b622"),c=o("iterator"),u=o("toStringTag"),l=a.values;for(var d in s){var h=r[d],p=h&&h.prototype;if(p){if(p[c]!==l)try{i(p,c,l)}catch(m){p[c]=l}if(p[u]||i(p,u,d),s[d])for(var f in a)if(p[f]!==a[f])try{i(p,f,a[f])}catch(m){p[f]=a[f]}}}},fdbc:function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}}}]);
//# sourceMappingURL=chunk-69c1d2aa.49167184.js.map